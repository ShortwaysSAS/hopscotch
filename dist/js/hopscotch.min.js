/**! shortways-hopscotch - v0.2.7a
*
* Copyright 2017 LinkedIn Corp. All rights reserved.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
!function(a){!function(b){"use strict";if("object"==typeof exports)module.exports=b();else{var c="hopscotch";if(a[c])return;a[c]=b()}}(function(){function a(){return!!(window.ShortwaysAssistant.defaultSelector&&window.ShortwaysAssistant.defaultSelector.toJQuery||window.jQuery||window.$&&window.$.fn)}function b(a,b){return window.ShortwaysAssistant.defaultSelector&&window.ShortwaysAssistant.defaultSelector.toJQuery(a,b)||window.jQuery(a,b)||window.$(a,b)}function c(a){return"requestAnimationFrame"in window?window.requestAnimationFrame(a):void setTimeout(a,16)}function d(a,b,c){a.self===a?a.scrollTo(b,c):(a.scrollLeft=b,a.scrollTop=c)}function e(a,b,c){var d,e,f,g,h,i,j,k=a.boundingClientRect,l=c&&null!=c.left?c.left:.5,m=c&&null!=c.top?c.top:.5,n=c&&null!=c.leftOffset?c.leftOffset:0,o=c&&null!=c.topOffset?c.topOffset:0,p=l,q=m;if(b.self===b)i=Math.min(k.width,b.innerWidth),j=Math.min(k.height,b.innerHeight),e=k.left+b.pageXOffset-b.innerWidth*p+i*p,f=k.top+b.pageYOffset-b.innerHeight*q+j*q,e-=n,f-=o,g=e-b.pageXOffset,h=f-b.pageYOffset;else{i=k.width,j=k.height,d=b.getBoundingClientRect();var r=k.left-(d.left-b.scrollLeft),s=k.top-(d.top-b.scrollTop);e=r+i*p-b.clientWidth*p,f=s+j*q-b.clientHeight*q,e=Math.max(Math.min(e,b.scrollWidth-b.clientWidth),0),f=Math.max(Math.min(f,b.scrollHeight-b.clientHeight),0),e-=n,f-=o,g=e-b.scrollLeft,h=f-b.scrollTop}return{x:e,y:f,differenceX:g,differenceY:h}}function f(a){var b=a._scrollSettings;if(b){var g=e(b.target,a,b.align),h=Date.now()-b.startTime,i=Math.min(1/b.time*h,1);if(h>b.time&&b.endIterations>3)return d(a,g.x,g.y),a._scrollSettings=null,b.end(E);b.endIterations++;var j=1-b.ease(i);return d(a,g.x-g.differenceX*j,g.y-g.differenceY*j),h>=b.time?f(a):void c(f.bind(null,a))}}function g(a,b,c,d){function e(a){b._scrollSettings=null,b.parentElement&&b.parentElement._scrollSettings&&b.parentElement._scrollSettings.end(a),d(a),b.removeEventListener("touchstart",g,{passive:!0})}var g,h=!b._scrollSettings,i=b._scrollSettings,j=Date.now();i&&i.end(F),b._scrollSettings={startTime:i?i.startTime:Date.now(),endIterations:0,target:a,time:c.time+(i?j-i.startTime:0),ease:c.ease,align:c.align,end:e},g=e.bind(null,F),b.addEventListener("touchstart",g,{passive:!0}),h&&f(b)}function h(a){return"pageXOffset"in a||(a.scrollHeight!==a.clientHeight||a.scrollWidth!==a.clientWidth)&&!0}function i(){return!0}var j,k,l,m,n,o,p,q,r,s,t,u,v,w="bubble_default",x=(window.Sizzle||null,"undefined"),y=!1,z=!1,A=!1,B=window.document,C=/^[a-zA-Z]+[a-zA-Z0-9_-]*$/,D={left:"right",right:"left"},E="complete",F="canceled";try{typeof window.sessionStorage!==x&&(z=!0,sessionStorage.setItem("hopscotch.test.storage","ok"),sessionStorage.removeItem("hopscotch.test.storage"),A=!0)}catch(G){}return u={smoothScroll:!0,scrollDuration:1e3,scrollTopMargin:200,showCloseButton:!0,showPrevButton:!1,showNextButton:!0,bubbleWidth:280,bubblePadding:15,arrowWidth:20,skipIfNoElement:!1,isRtl:!1,cookieName:"hopscotch.tour.state"},Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),t=function(){y&&v.startTour()},q={addClass:function(a,b){var c,d,e,f;if(a.className){for(d=b.split(/\s+/),c=" "+a.className+" ",e=0,f=d.length;f>e;++e)c.indexOf(" "+d[e]+" ")<0&&(c+=d[e]+" ");a.className=c.replace(/^\s+|\s+$/g,"")}else a.className=b},removeClass:function(a,b){var c,d,e,f;for(d=b.split(/\s+/),c=" "+a.className+" ",e=0,f=d.length;f>e;++e)c=c.replace(" "+d[e]+" "," ");a.className=c.replace(/^\s+|\s+$/g,"")},hasClass:function(a,b){var c;return a.className?(c=" "+a.className+" ",-1!==c.indexOf(" "+b+" ")):!1},getPixelValue:function(a){var b=typeof a;return"number"===b?a:"string"===b?parseInt(a,10):0},valOrDefault:function(a,b){return typeof a!==x?a:b},invokeCallbackArrayHelper:function(a){var b;return Array.isArray(a)&&(b=s[a[0]],"function"==typeof b)?b.apply(this,a.slice(1)):void 0},invokeCallbackArray:function(a){var b,c;if(Array.isArray(a)){if("string"==typeof a[0])return q.invokeCallbackArrayHelper(a);for(b=0,c=a.length;c>b;++b)q.invokeCallback(a[b])}},invokeCallback:function(a){return"function"==typeof a?a():"string"==typeof a&&s[a]?s[a]():q.invokeCallbackArray(a)},invokeEventCallbacks:function(a,b){var c,d,e=r[a];if(b)return this.invokeCallback(b);for(c=0,d=e.length;d>c;++c)this.invokeCallback(e[c].cb)},getScrollTop:function(){var a;return a=typeof window.pageYOffset!==x?window.pageYOffset:B.documentElement.scrollTop},getIframeScrollTop:function(a){var c=q.splitTargetChain(a),d=b(c[0]).contents().find("html, body");return d.scrollTop()},getScrollLeft:function(){var a;return a=typeof window.pageXOffset!==x?window.pageXOffset:B.documentElement.scrollLeft},getWindowHeight:function(){return window.innerHeight||B.documentElement.clientHeight},addEvtListener:function(a,b,c){return a?a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c):void 0},removeEvtListener:function(a,b,c){return a?a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c):void 0},documentIsReady:function(){return"complete"===B.readyState},evtPreventDefault:function(a){a.preventDefault?a.preventDefault():event&&(event.returnValue=!1)},extend:function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},getStepTargetHelper:function(a){return ShortwaysAssistant.targetService.getTarget(a)},getStepTarget:function(a){return a&&a.target?q.getStepTargetHelper(a.target):Promise.resolve(null)},getI18NString:function(a){return n[a]||m[a]},setState:function(a,b,c){var d,e="";if(z&&A)try{sessionStorage.setItem(a,b)}catch(f){A=!1,this.setState(a,b,c)}else z&&sessionStorage.removeItem(a),c&&(d=new Date,d.setTime(d.getTime()+24*c*60*60*1e3),e="; expires="+d.toGMTString()),B.cookie=a+"="+b+e+"; path=/"},getState:function(a){var b,c,d,e=a+"=",f=B.cookie.split(";");if(z&&(d=sessionStorage.getItem(a)))return d;for(b=0;b<f.length;b++){for(c=f[b];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(e)){d=c.substring(e.length,c.length);break}}return d},clearState:function(a){z?sessionStorage.removeItem(a):this.setState(a,"",-1)},normalizePlacement:function(a){!a.placement&&a.orientation&&(a.placement=a.orientation)},flipPlacement:function(a){if(a.isRtl&&!a._isFlipped){var b,c,d=["orientation","placement"];a.xOffset&&(a.xOffset=-1*this.getPixelValue(a.xOffset));for(c in d)b=d[c],a.hasOwnProperty(b)&&D.hasOwnProperty(a[b])&&(a[b]=D[a[b]]);a._isFlipped=!0}},actualOffset:function(a){},splitTargetChain:function(a){return a.split("//://").map(function(a){return a.replace(":contains(",':not([class^="hopscotch-bubble"]):contains(')})},isTargetElmtOnRoot:function(a){return!0},scrollIntoView:function(a,b,c){function d(a){f--,f||c&&c(a)}if(a){"function"==typeof b&&(c=b,b=null),b||(b={}),b.time=isNaN(b.time)?1e3:b.time,b.ease=b.ease||function(a){return 1-Math.pow(1-a,a/2)};for(var e=a.parentElement,f=0,j=b.validTarget||i,k=b.isScrollable;e;){if(j(e,f)&&(k?k(e,h):h(e))&&(f++,g(a,e,b,d)),e=e.parentElement,!e)return;("BODY"===e.tagName||"HTML"===e.tagName)&&(e=e.ownerDocument,e=e.defaultView||e.ownerWindow)}}},isVisible:function(a){return a&&a.isVisible},elementInViewport:function(a){for(var b=a.offsetTop,c=a.offsetLeft,d=a.offsetWidth,e=a.offsetHeight;a.offsetParent;)a=a.offsetParent,b+=a.offsetTop,c+=a.offsetLeft;return b>=window.pageYOffset&&c>=window.pageXOffset&&b+e<=window.pageYOffset+window.innerHeight&&c+d<=window.pageXOffset+window.innerWidth}},q.addEvtListener(window,"load",t),r={next:[],prev:[],start:[],end:[],show:[],error:[],close:[]},s={},m={stepNums:null,nextBtn:"Next",prevBtn:"Back",doneBtn:"Done",skipBtn:"Skip",closeTooltip:"Close"},n={},k=function(a){this.init(a)},k.prototype={isShowing:!1,currStep:void 0,hasAlreadyBeenDisplayed:!1,setPosition:function(a){var b,c,d,e,f,g,h=this.element,i=this.arrowEl,j=a.isRtl?"right":"left",k=this;q.getStepTarget(a).then(function(l){function m(){return a.isRtl?d.right-c:d.left}function n(){var a=0;return d.top+parseFloat(a.paddingTop)+parseFloat(a.borderTopWidth)-22}if(!l||!l.isVisible)return void(k.isShowing&&k.hide());switch(!k.isShowing&&k.hasAlreadyBeenDisplayed&&k.show(),q.flipPlacement(a),q.normalizePlacement(a),q.removeClass(h,"fade-in-down fade-in-up fade-in-left fade-in-right"),"AREA"===l.tagName?(c=b=0,d={top:0,right:0,bottom:0,left:0,height:0,width:0,x:0,y:0}):(c=h.offsetWidth,b=h.offsetHeight,d=l.boundingClientRect),a.placement){case"top":e=d.top-b-k.opt.arrowWidth,f=m();break;case"bottom":e=d.bottom+k.opt.arrowWidth,f=m();break;case"left":e=n(),f=d.left-c-k.opt.arrowWidth;break;case"right":e=n(),f=d.right+k.opt.arrowWidth;break;default:throw new Error("Bubble placement failed because step.placement is invalid or undefined!")}g="center"!==a.arrowOffset?q.getPixelValue(a.arrowOffset):a.arrowOffset,"top"===a.placement||"bottom"===a.placement?("top"===a.placement?(i.style.top="",i.style.bottom="-39px"):(i.style.top="-22px",i.style.bottom=""),g?"center"===g?i.style[j]=Math.floor(c/2-i.offsetWidth/2)+"px":g&&(i.style[j]=g+"px"):i.style.left="10px"):("left"===a.placement||"right"===a.placement)&&("left"===a.placement?(i.style.left="",i.style.right="-39px"):(i.style.left="-22px",i.style.right=""),g?"center"===g?i.style.top=Math.floor(b/2-i.offsetHeight/2)+"px":g&&(i.style.top=g+"px"):i.style.top="10px");var o={top:0,bottom:0,left:0,right:0};"center"===a.xOffset?f=d.left+l.offsetWidth/2-c/2:f+=q.getPixelValue(a.xOffset)+o.left,"center"===a.yOffset?e=d.top+l.offsetHeight/2-b/2:e+=q.getPixelValue(a.yOffset)+o.top,!a.fixedElement&&q.isTargetElmtOnRoot(l)?(e+=q.getScrollTop(),f+=q.getScrollLeft()):a.fixedElement||(e+=q.getIframeScrollTop(a.target)),h.style.position=a.fixedElement?"fixed":"absolute",h.style.top=e+"px",h.style.left=f+"px"})},render:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this.element;if(a?this.currStep=a:this.currStep&&(a=this.currStep),this.opt.isTourBubble?(g=v.getCurrTour(),g&&(e=g.customData,d=g.customRenderer,a.isRtl=a.hasOwnProperty("isRtl")?a.isRtl:g.hasOwnProperty("isRtl")?g.isRtl:this.opt.isRtl,f=g.unsafe,Array.isArray(g.steps)&&(h=g.steps.length,i=this._getStepI18nNum(this._getStepNum(h-1)),k=this._getStepNum(b)===this._getStepNum(h-1)))):(e=a.customData,d=a.customRenderer,f=a.unsafe,a.isRtl=a.hasOwnProperty("isRtl")?a.isRtl:this.opt.isRtl),j=k?q.getI18NString("doneBtn"):a.showSkip?q.getI18NString("skipBtn"):q.getI18NString("nextBtn"),q.flipPlacement(a),q.normalizePlacement(a),this.placement=a.placement,m={i18n:{prevBtn:q.getI18NString("prevBtn"),nextBtn:j,closeTooltip:q.getI18NString("closeTooltip"),stepNum:this._getStepI18nNum(this._getStepNum(b)),numSteps:i},buttons:{showPrev:q.valOrDefault(a.showPrevButton,this.opt.showPrevButton)&&this._getStepNum(b)>0,showNext:q.valOrDefault(a.showNextButton,this.opt.showNextButton),showCTA:q.valOrDefault(a.showCTAButton&&a.ctaLabel,!1),ctaLabel:a.ctaLabel,showClose:q.valOrDefault(this.opt.showCloseButton,!0)},step:{num:b,isLast:q.valOrDefault(k,!1),title:a.title||"",content:a.content||"",isRtl:a.isRtl,placement:a.placement,padding:q.valOrDefault(a.padding,this.opt.bubblePadding),width:q.getPixelValue(a.width)||this.opt.bubbleWidth,customData:a.customData||{}},tour:{isTour:this.opt.isTourBubble,numSteps:h,unsafe:q.valOrDefault(f,!1),customData:e||{}}},"function"==typeof d)n.innerHTML=d(m);else if("string"==typeof d){if(!v.templates||"function"!=typeof v.templates[d])throw new Error('Bubble rendering failed - template "'+d+'" is not a function.');n.innerHTML=v.templates[d](m)}else if(o)n.innerHTML=o(m);else{if(!v.templates||"function"!=typeof v.templates[w])throw new Error('Bubble rendering failed - template "'+w+'" is not a function.');n.innerHTML=v.templates[w](m)}for(var p,r=n.children,s=r.length,l=0;s>l;l++)p=r[l],q.hasClass(p,"hopscotch-arrow")&&(this.arrowEl=p);return n.style.zIndex="number"==typeof a.zindex?a.zindex:"",this._setArrow(a.placement),this.hide(!1),this.setPosition(a),c&&c(!a.fixedElement),this},_getStepNum:function(a){var b,c,d=0,e=v.getSkippedStepsIndexes(),f=e.length;for(c=0;f>c;c++)b=e[c],a>b&&d++;return a-d},_getStepI18nNum:function(a){var b=q.getI18NString("stepNums");return b&&a<b.length?a=b[a]:a+=1,a},_setArrow:function(a){q.removeClass(this.arrowEl,"down up right left"),"top"===a?q.addClass(this.arrowEl,"down"):"bottom"===a?q.addClass(this.arrowEl,"up"):"left"===a?q.addClass(this.arrowEl,"right"):"right"===a&&q.addClass(this.arrowEl,"left")},_getArrowDirection:function(){return"top"===this.placement?"down":"bottom"===this.placement?"up":"left"===this.placement?"right":"right"===this.placement?"left":void 0},show:function(){this.isShowing=!0;var a=this,b="fade-in-"+this._getArrowDirection(),c=1e3;return q.removeClass(this.element,"hide"),q.addClass(this.element,b),setTimeout(function(){q.removeClass(a.element,"invisible")},50),setTimeout(function(){q.removeClass(a.element,b)},c),this.hasAlreadyBeenDisplayed=!0,this},hide:function(a){var b=this.element;return a=q.valOrDefault(a,!0),b.style.top="",b.style.left="",a?(q.addClass(b,"hide"),q.removeClass(b,"invisible")):(q.removeClass(b,"hide"),q.addClass(b,"invisible")),q.removeClass(b,"animate fade-in-up fade-in-down fade-in-right fade-in-left"),this.isShowing=!1,this},destroy:function(){var a=this.element;a&&a.parentNode.removeChild(a),q.removeEvtListener(a,"click",this.clickCb),this.hasAlreadyBeenDisplayed=!1},reset:function(){this.hide(),this.hasAlreadyBeenDisplayed=!1},_handleBubbleClick:function(a){function b(c){return c===a.currentTarget?null:q.hasClass(c,"hopscotch-cta")?"cta":q.hasClass(c,"hopscotch-next")?"next":q.hasClass(c,"hopscotch-prev")?"prev":q.hasClass(c,"hopscotch-close")?"close":b(c.parentElement)}var c;a=a||window.event;var d=a.target||a.srcElement;if(c=b(d),"cta"===c)this.opt.isTourBubble||v.getCalloutManager().removeCallout(this.currStep.id),this.currStep.onCTA&&q.invokeCallback(this.currStep.onCTA);else if("next"===c)v.nextStep(!0);else if("prev"===c)v.prevStep(!0);else if("close"===c){if(this.opt.isTourBubble){var e=v.getCurrStepNum(),f=v.getCurrTour(),g=e===f.steps.length-1;q.invokeEventCallbacks("close"),v.endTour(!0,g)}else this.opt.onClose&&q.invokeCallback(this.opt.onClose),this.opt.id&&!this.opt.isTourBubble?v.getCalloutManager().removeCallout(this.opt.id):this.destroy();q.evtPreventDefault(a)}},init:function(a){var b,c,d,e,f=B.createElement("div"),g=this,h=!1;this.element=f,e={showPrevButton:u.showPrevButton,showNextButton:u.showNextButton,bubbleWidth:u.bubbleWidth,bubblePadding:u.bubblePadding,arrowWidth:u.arrowWidth,isRtl:u.isRtl,showNumber:!0,isTourBubble:!0},a=typeof a===x?{}:a,q.extend(e,a),this.opt=e,B.documentMode&&e.instantFadeIn?f.className="shortways-hopscotch hopscotch-bubble":f.className="shortways-hopscotch hopscotch-bubble animated",e.isTourBubble?(d=v.getCurrTour(),d&&q.addClass(f,"tour-"+d.id)):q.addClass(f,"hopscotch-callout no-number"),b=function(){!h&&g.isShowing&&(h=!0,setTimeout(function(){g.setPosition(g.currStep),h=!1},100))},q.addEvtListener(window,"resize",b),this.clickCb=function(a){g._handleBubbleClick(a)},q.addEvtListener(f,"click",this.clickCb),this.hide(),q.documentIsReady()?B.body.appendChild(f):(B.addEventListener?(c=function(){B.removeEventListener("DOMContentLoaded",c),window.removeEventListener("load",c),B.body.appendChild(f)},B.addEventListener("DOMContentLoaded",c,!1)):(c=function(){"complete"===B.readyState&&(B.detachEvent("onreadystatechange",c),window.detachEvent("onload",c),B.body.appendChild(f))},B.attachEvent("onreadystatechange",c)),q.addEvtListener(window,"load",c))}},l=function(){var a={},b={};this.createCallout=function(c){var d;if(!c.id)throw new Error("Must specify a callout id.");if(!C.test(c.id))throw new Error("Callout ID is using an invalid format. Use alphanumeric, underscores, and/or hyphens only. First character must be a letter.");if(a[c.id])throw new Error("Callout by that id already exists. Please choose a unique id.");return c.showNextButton=c.showPrevButton=!1,c.isTourBubble=!1,d=new k(c),a[c.id]=d,b[c.id]=c,d.render(c,null,function(){d.show(),c.onShow&&q.invokeCallback(c.onShow)}),d},this.getCallout=function(b){return a[b]},this.removeAllCallouts=function(){var b;for(b in a)a.hasOwnProperty(b)&&this.removeCallout(b)},this.removeCallout=function(c){var d=a[c];a[c]=null,b[c]=null,d&&d.destroy()},this.refreshCalloutPositions=function(){var c,d,e;for(c in a)a.hasOwnProperty(c)&&b.hasOwnProperty(c)&&(d=a[c],e=b[c],d&&e&&q.getStepTarget(e).then(function(a){a&&q.isVisible(a)?(d.show(),d.setPosition(e)):d.hide()}))}},j=function(b){var c,d,e,f,g,h,i,j,m,t={},z=[],A=function(a){return c&&c.element&&c.element.parentNode||(c=new k(e)),a&&q.extend(c.opt,{bubblePadding:E("bubblePadding"),bubbleWidth:E("bubbleWidth"),showNextButton:E("showNextButton"),showPrevButton:E("showPrevButton"),showCloseButton:E("showCloseButton"),arrowWidth:E("arrowWidth"),isRtl:E("isRtl")}),c},D=function(){c&&(c.destroy(),c=null)},E=function(a){return"undefined"==typeof e?u[a]:q.valOrDefault(e[a],u[a])},F=function(){var a;return a=!f||g||0>h||h>=f.steps.length?null:f.steps[h]},G=function(b){if(a()){const c=F();q.getStepTarget(c).then(function(a){if(E("scrollImmediate")||B.documentMode&&E("compatMode")){const d="top"===c.placement;if(a.scrollIntoView(!d),b(),E("doNotAdjustScroll"))return;const e=a.boundingClientRect,f=e.top<window.innerHeight/1.5,g=e.top>B.body.offsetHeight-window.innerHeight/1.2,h=!f&&!g||d&&g||!d&&f;h&&window.scrollBy(0,d?window.innerHeight/2:window.innerHeight/-2)}else b()})}},H=function(a,b){var c,d;h+a>=0&&h+a<f.steps.length?(h+=a,c=F(),d=function(){q.getStepTarget(c).then(function(c){c?(t[h]&&delete t[h],b(h)):(t[h]=!0,q.invokeEventCallbacks("error"),H(a,b))})},c.delay?setTimeout(d,c.delay):d()):b(-1)},I=function(a,b){var c,d,e,g,i=A(),j=this;if(i.reset(),a=q.valOrDefault(a,!0),c=F(),d=c,e=b>0?d.multipage:h>0&&f.steps[h-1].multipage,g=function(c,d){var f;if(-1===c)return this.endTour(!0);if(a&&(f=b>0?q.invokeEventCallbacks("next",d.onNext):q.invokeEventCallbacks("prev",d.onPrev)),c===h){if(e)return void M();f=q.valOrDefault(f,!0),f?this.showStep(c):this.endTour(!1)}},!e&&E("skipIfNoElement"))H(b,function(a){g.call(j,a,d)});else if(h+b>=0&&h+b<f.steps.length){h+=b,c=F(),q.getStepTarget(c).then(function(a){return a.isFound||e?void g.call(this,h,d):(q.invokeEventCallbacks("error"),d.showNextButton?this.endTour(!0,!1,!0):this.endTour(!0,!1))})}else if(h+b===f.steps.length)return this.endTour();return this},J=function(a){var b,c,d,e={};for(b in a)a.hasOwnProperty(b)&&"id"!==b&&"steps"!==b&&(e[b]=a[b]);return m.call(this,e,!0),c=q.getState(E("cookieName")),c&&(d=c.split(":"),i=d[0],j=d[1],d.length>2&&(z=d[2].split(",")),j=parseInt(j,10)),this},K=function(a,b,c){var d;h=a||0,t=b||{},d=F(),q.getStepTarget(d).then(function(a){if(a)return void c(h);if(!a){if(q.invokeEventCallbacks("error"),t[h]=!0,E("skipIfNoElement"))return void H(1,c);h=-1,c(h)}})},L=function(a){function b(){d.show(),q.invokeEventCallbacks("show",c.onShow)}var c=f.steps[a],d=A();h=a,d.hide(!1),d.render(c,a,function(a){a?G(b):b()}),M()},M=function(){var a=f.id+":"+h,b=v.getSkippedStepsIndexes();b&&b.length>0&&(a+=":"+b.join(",")),q.setState(E("cookieName"),a,1)},N=function(a){a&&this.configure(a)};this.getCalloutManager=function(){return typeof d===x&&(d=new l),d},this.startTour=function(a,b){var c,d,e={},h=this;if(!f||g){if(!a)throw new Error("Tour data is required for startTour.");if(!a.id||!C.test(a.id))throw new Error("Tour ID is using an invalid format. Use alphanumeric, underscores, and/or hyphens only. First character must be a letter.");g=!1,f=a,J.call(this,a)}if(typeof b!==x){if(b>=f.steps.length)throw new Error("Specified step number out of bounds.");d=b}if(!q.documentIsReady())return y=!0,this;if("undefined"==typeof d&&f.id===i&&typeof j!==x){if(d=j,z.length>0)for(var k=0,l=z.length;l>k;k++)e[z[k]]=!0}else d||(d=0);return K(d,e,function(a){return-1===a?void h.endTour(!1,!1):void q.getStepTarget(f.steps[a]).then(function(b){return b.isFound?(q.invokeEventCallbacks("start"),c=A(),c.hide(!1),h.isActive=!0,void q.getStepTarget(F()).then(function(b){b.isFound?h.showStep(a):(q.invokeEventCallbacks("error"),E("skipIfNoElement")&&h.nextStep(!1))})):void h.endTour(!1,!1)})}),this},this.showStep=function(a){var b=f.steps[a],c=h;return q.getStepTarget(b).then(function(d){return d.isFound?void(b.delay?setTimeout(function(){L(a)},b.delay):L(a)):(h=a,q.invokeEventCallbacks("error"),void(h=c))}),this},this.prevStep=function(a){return I.call(this,a,-1),this},this.nextStep=function(a){return I.call(this,a,1),this},this.endTour=function(a,b,c){var d=A();return a=q.valOrDefault(a,!0),b=q.valOrDefault(b,!0),h=0,j=void 0,d.hide(),a&&q.clearState(E("cookieName")),this.isActive&&(this.isActive=!1,f&&b&&q.invokeEventCallbacks("end")),this.removeCallbacks(null,!0),this.resetDefaultOptions(),D(),c?g=!0:f=null,this},this.getCurrTour=function(){return f},this.getCurrTarget=function(){return q.getStepTarget(F())},this.getCurrStepNum=function(){return h},this.getSkippedStepsIndexes=function(){var a,b=[];for(a in t)b.push(a);return b},this.refreshBubblePosition=function(){var a=F();return a&&A().setPosition(a),this.getCalloutManager().refreshCalloutPositions(),this},this.listen=function(a,b,c){return a&&r[a].push({cb:b,fromTour:c}),this},this.unlisten=function(a,b){for(var c,d,e=r[a],c=0,d=e.length;d>c;++c)e[c].cb===b&&e.splice(c,1);return this},this.removeCallbacks=function(a,b){var c,d,e,f;for(f in r)if(!a||a===f)if(b)for(c=r[f],d=0,e=c.length;e>d;++d)c[d].fromTour&&(c.splice(d--,1),--e);else r[f]=[];return this},this.registerHelper=function(a,b){"string"==typeof a&&"function"==typeof b&&(s[a]=b)},this.unregisterHelper=function(a){s[a]=null},this.invokeHelper=function(a){var b,c,d=[];for(b=1,c=arguments.length;c>b;++b)d.push(arguments[b]);s[a]&&s[a].call(null,d)},this.setCookieName=function(a){return e.cookieName=a,this},this.resetDefaultOptions=function(){return e={},this},this.resetDefaultI18N=function(){return n={},this},this.getState=function(){return q.getState(E("cookieName"))},m=function(a,b){var c,d,f,g,h=["next","prev","start","end","show","error","close"];for(e||this.resetDefaultOptions(),q.extend(e,a),a&&q.extend(n,a.i18n),f=0,g=h.length;g>f;++f)d="on"+h[f].charAt(0).toUpperCase()+h[f].substring(1),a[d]&&this.listen(h[f],a[d],b);return c=A(!0),this},this.configure=function(a){return m.call(this,a,!1)},this.setRenderer=function(a){var b=typeof a;return"string"===b?(w=a,o=void 0):"function"===b&&(o=a),this},this.setEscaper=function(a){return"function"==typeof a&&(p=a),this},N.call(this,b)},v=new j,function(){var a={};a.escape=function(a){return p?p(a):null==a?"":(""+a).replace(new RegExp("[&<>\"']","g"),function(a){return"&"==a?"&amp;":"<"==a?"&lt;":">"==a?"&gt;":'"'==a?"&quot;":"'"==a?"&#x27;":void 0})},this.templates=this.templates||{},this.templates.bubble_default=function(b){function c(b,c){return c?a.escape(b):b}var d,e="";a.escape,Array.prototype.join;e+="\n";var f=b.i18n,g=b.buttons,h=b.step,i=b.tour;return e+='\n<div class="hopscotch-bubble-container" style="width: '+(null==(d=h.width)?"":d)+"px; padding: "+(null==(d=h.padding)?"":d)+'px;">\n  ',i.isTour&&(e+='<span class="hopscotch-bubble-number">'+(null==(d=f.stepNum)?"":d)+"</span>"),e+='\n  <div class="hopscotch-bubble-content">\n    ',""!==h.title&&(e+='<h3 class="hopscotch-title">'+(null==(d=c(h.title,i.unsafe))?"":d)+"</h3>"),e+="\n    ",""!==h.content&&(e+='<div class="hopscotch-content">'+(null==(d=c(h.content,i.unsafe))?"":d)+"</div>"),e+='\n  </div>\n  <div class="hopscotch-actions">\n    ',g.showPrev&&(e+='<button class="hopscotch-nav-button hopscotch-prev">'+(null==(d=f.prevBtn)?"":d)+"</button>"),e+="\n    ",g.showCTA&&(e+='<button class="hopscotch-nav-button hopscotch-cta">'+(null==(d=g.ctaLabel)?"":d)+"</button>"),e+="\n    ",g.showNext&&(e+='<button class="hopscotch-nav-button hopscotch-next">'+(null==(d=f.nextBtn)?"":d)+"</button>"),e+="\n  </div>\n  ",g.showClose&&(e+='<button class="hopscotch-bubble-close hopscotch-close">'+(null==(d=f.closeTooltip)?"":d)+"</button>"),e+='\n</div>\n<div class="hopscotch-bubble-arrow-container hopscotch-arrow">\n  <div class="hopscotch-bubble-arrow-border"></div>\n  <div class="hopscotch-bubble-arrow"></div>\n</div>\n'}}.call(v),v})}(window.ShortwaysAssistant||(window.ShortwaysAssistant={}));